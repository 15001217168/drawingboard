<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"
    />
    <title>作业批改</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css" />
    <link rel="stylesheet" type="text/css" href="../css/style.css" />
    <link rel="stylesheet" type="text/css" href="../css/check.css" />
</head>

<body id="data-box">
    <div class="container">
        <div class="fn-left handle_menu_wrap">
            <div class="menu_title">
                工具
            </div>
            <div id="tools" class="handle_btn_list">
                <div class="handle_btn active" data-type="right">
                    <div class="handle_btn_img">
                        <img src="../image/check/all-true.png" class="center-self" alt="">
                    </div>
                    <div class="handle_btn_name">
                        全对
                    </div>
                </div>
                <div class="handle_btn" data-type="rectangle">
                    <div class="handle_btn_img">
                        <img src="../image/check/label-icon.png" class="center-self" alt="">
                    </div>
                    <div class="handle_btn_name">
                        错题标注
                    </div>
                </div>
                <div class="handle_btn" data-type="wrong">
                    <div class="handle_btn_img">
                        <img src="../image/check/all-wrong.png" class="center-self" alt="">
                    </div>
                    <div class="handle_btn_name">
                        全错
                    </div>
                </div>
                <div class="handle_btn" data-type="smallright">
                    <div class="handle_btn_img">
                        <img src="../image/check/true-icon.png" class="center-self" alt="">
                    </div>
                    <div class="handle_btn_name">
                        正确处
                    </div>
                </div>
                <div class="handle_btn" data-type="smallwrong">
                    <div class="handle_btn_img">
                        <img src="../image/check/wrong-icon.png" class="center-self" alt="">
                    </div>
                    <div class="handle_btn_name">
                        错误处
                    </div>
                </div>
                <div class="handle_btn" data-type="remove">
                    <div class="handle_btn_img">
                        <img src="../image/check/erasure-icon.png" class="center-self" alt="">
                    </div>
                    <div class="handle_btn_name">
                        擦除
                    </div>
                </div>
                <div class="handle_btn" data-type="help">
                    <div class="handle_btn_img">
                        <img src="../image/check/help-icon.png" class="center-self" alt="">
                    </div>
                    <div class="handle_btn_name">
                        帮助
                    </div>
                </div>
            </div>
        </div>
        <div class="fn-right correct_main">
            <div class="wrong_list_wrap">
                <div class="wrong_list_title">
                    <i class="before_icon fn-left"></i>
                    <div>错题</div>
                </div>
                <div class="wrong_list">
                    <div id="errMsg" class="wrong_list_inner">

                    </div>
                </div>
            </div>
            <div class="main_score">
                <div class="main_score_title">
                    <i class="before_icon fn-left"></i>
                    <div>字迹评分</div>
                </div>
                <div class="main_score_num_list fn-clear">
                    <div class="main_score_num_item fn-left">1</div>
                    <div class="main_score_num_item fn-left">2</div>
                    <div class="main_score_num_item fn-left">3</div>
                    <div class="main_score_num_item fn-left">4</div>
                    <div class="main_score_num_item fn-left">5</div>
                    <div class="main_score_num_item fn-left">6</div>
                    <div class="main_score_num_item fn-left">7</div>
                    <div class="main_score_num_item fn-left">8</div>
                    <div class="main_score_num_item fn-left">9</div>
                    <div class="main_score_num_item fn-left">10</div>
                </div>
            </div>
            <div class="small_btn_blue confirm">
                确认完成
            </div>
            <div class="more_btn"></div>
            <div class="other_btn_wrap fn-hide">
                <div class="mark_exce">
                    异常标记
                </div>
                <div class="give_up">
                    放弃任务
                </div>
            </div>
        </div>
        <div class="fn-right preview">
            <div id="simgDiv" class="swiper-container">

            </div>
            <div class="homework_total center-self-x">
                <span>1</span>/
                <span>5</span>
            </div>
        </div>
        <div class="view">
            <div id="canvasDiv" class="swiper-container center-self">
                <!-- <canvas id="c0" height="1100" width="825">请使用支持HTML5的浏览器</canvas> -->
            </div>
        </div>
    </div>
    <div id="errModal" class="mark_error_modal fn-hide">
        <div class="mark_error_box center-self">
            <div class="mark_error_box_title">
                <div class="fn-left">
                    选择错误标签
                </div>
                <div id="hideModal" class="fn-right close_icon fn-clear fn-hide">
                    <img src="../image/check/close-icon.png" class="fn-left" alt="">
                </div>
            </div>
            <div id="errTags" class="wrong_label_list">

            </div>
            <div id="errVerify" class="small_btn_blue center-self-x confirm_mark">
                确认
            </div>
        </div>
    </div>
</body>
<script type="text/javascript" src="../js/check/JSfontsize.js"></script>
<script type="text/javascript" src="../js/jquery.min.js"></script>
<script type="text/javascript" src="../js/check/Rivets.js"></script>
<script type="text/javascript" src="../js/check/tool.js"></script>
<script type="text/javascript" src="js/fabric.min.js"></script>
<script type="text/javascript" src="js/check/check.js"></script>

<script type="text/javascript">


    jQuery(function () {

        var errTagType = {
            '语文': ['遗漏', '理解不清晰', '粗心大意', '审题不清', '基础不牢', '积累不够', '运用错误', '区分错误', '缺乏逻辑'],
            '数学': ['计算错误', '审题错误', '遗漏', '基础不牢固', '粗心大意', '概念不清', '换算错误', '公式不熟练', '缺乏解题技巧', '书写不端正'],
            '英语': ['粗心大意', '审题错误', '基础不牢固', '书写不规范', '单词拼写错误', '遗漏', '介词搭配错误', '单复数错误']
        };

        //获取url中的参数
        function getUrlParam(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return decodeURI(r[2]);
            return null;
        }

        var img = decodeURIComponent(getUrlParam('img')); //图片集合
        var subject = decodeURIComponent(getUrlParam('subject')); //科目
        if (!img && JSON.parse(img)) {
            alert("网络错误");
        }
        img = JSON.parse(img);

        var simgEle = "";
        for (var i = 0; i < img.length; i++) {
            jQuery("#canvasDiv").append('<canvas id="c' + i + '" height="1100" width="825"></canvas>');
            if (i == 0) {
                switchCanvas(img[i].i, 0);
                simgEle += '<div class="swiper-slide swiper-slide-visible swiper-slide-active active-nav">';
            } else {
                simgEle += '<div class="swiper-slide swiper-slide-visible">';
            }
            simgEle += '<div class="slide_inner">' +
                '<img src="' + img[i].s + '" class="center-self"></div></div>';

        }



        jQuery("#simgDiv").append(simgEle);

        jQuery(".swiper-slide-visible").on("click", function () {
            jQuery(this).addClass("active-nav").siblings().removeClass("active-nav");
            switchCanvas(img[jQuery(this).index()].i, jQuery(this).index());
        });

        //隐藏弹窗
        jQuery("#hideModal").on("click", function () {
            jQuery("#errModal").addClass("fn-hide");
        });

        //弹窗科目错误设置
        if (subject && errTagType[subject] && errTagType[subject].length > 0) {
            for (var i = 0; i < errTagType[subject].length; i++) {
                jQuery('#errTags').append('<div name="etag" class="wrong_label fn-left">' + errTagType[subject][i] + '</div>');
            }
        }

        //错误标签点击
        jQuery("div[name=etag]").on("click", function () {
            jQuery(this).toggleClass("active");
        });

        //错误标签选定
        jQuery("#errVerify").on("click", function () {
            var errTags = jQuery('#errTags').find(".active");
            if (errTags.length <= 0) {
                alert('请先选中标签！');
                return false;
            }
            var errSonEle = '<div class="wrong_item">';
            errSonEle += ' <i class="serial_number fn-left">' + appErrCount + '</i>';
            errSonEle += '<div class="wrong_content fn-clear">';
            for (var i = 0; i < errTags.length; i++) {
                errSonEle += '<div class="wrong_label fn-left">' + jQuery(errTags[i]).text() + '</div>';
            }
            errSonEle += '</div></div>';
            jQuery("#errMsg").prepend(errSonEle);
            jQuery("#errModal").addClass("fn-hide");
        });


    });




</script>

</html>